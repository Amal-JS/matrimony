{% extends 'auth_app/user_home_base.html' %}
{% load static %}

{% block title %} Update - Matrimony {% endblock %}

{% block main_content %}

            <form id="updateForm"> 
                {{oldData.looking_for}}
                <div class="flex mt-2">
                    <div class="w-1/4 flex items-center">
                        <p class="text-2xl text-black font-light mx-3 text-center">Looking For</p>
                    </div>
                    <div class="w-3/4">
                        <select id="registerSelect" name="looking_for" default-selected="{{oldData.looking_for}}" class="bg-white text-black font-normal w-full text-start py-3 rounded-xl border-2 border-gray-300 px-3">
                   
                            <option value=""> Select Profile</option>
                            <option value="Myself Male" >Myself Male</option>
                            <option value="Myself Female" >Myself Female</option>
                            <option value="Son"> Son </option>
                            <option value="Daughter"> Daughter</option>
                            <option value="Sister"> Sister</option>
                            <option value="Friend">Friend</option>
        
                        </select>
                    </div>
                </div>


                <div class="flex mt-2">
                    <div class="w-1/4 flex items-center">
                        <p class="text-2xl text-black font-light mx-3 text-center">Username</p>
                    </div>
                    <div class="w-3/4">
                      
                        <input class="w-full px-3 text-black mt-4 h-12  border-2 border-gray-400 rounded-xl" type="text" name="username" placeholder="{{oldData.username}}"/>
                    </div>
                </div>
                
                <div class="flex mt-2">
                    <div class="w-1/4 flex items-center">
                        <p class="text-2xl text-black font-light mx-3 text-center">Phone number</p>
                    </div>
                    <div class="w-3/4">
                        
                        <input class="w-full px-3 text-black mt-4 h-12 border-2 border-gray-400 rounded-xl" type="number" name="phone" placeholder="{{oldData.phone}}"/>
                    </div>
                </div>
                <div class="flex mt-2">
                    <div class="w-1/4 flex items-center">
                        <p class="text-2xl text-black font-light mx-3 text-center">Date of birth</p>
                    </div>
                    <div class="w-3/4">
                        
                        <input type="date" class="w-9/12" id="dob"/>                    </div>
                </div>
                <div class="flex mt-2">
                    <div class="w-1/4 flex items-center">
                        <p class="text-2xl text-black font-light mx-3 text-center">Religion</p>
                    </div>
                    <div class="w-3/4">
                        
                        <select id="registerSelectReligion" default-selected="{{oldData.religion}}" class="bg-white text-black font-normal  w-full text-start py-3 rounded-xl border-2 border-gray-300 px-3">
                   
                            <option value=""> Select Religion</option>
                            <option value="Christian" >Christian</option>
                            <option value="Muslim" >Muslim</option>
                            <option value="Hindu"> Hindu </option>
                      >
        
                        </select></div>
                </div>
                <div class="flex mt-2">
                    <div class="w-1/4 flex items-center">
                        <p class="text-2xl text-black font-light mx-3 text-center">Mother Tongue </p>
                    </div>
                    <div class="w-3/4">
                        
                        <select id="registerSelectLanguage" default-selected="{{oldData.language}}" class="bg-white text-black font-normal  w-full text-start py-3 rounded-xl border-2 border-gray-300 px-3">
                   
                            <option value=""> Select Language</option>
                            <option value="Malayalam" >Malayalam</option>
                            <option value="Tamil" >Tamil</option>
                            <option value="Hindi"> Hindi </option>
                          
        
                        </select>
                    </div>
                </div>
                <div class="flex mt-2">
                    <div class="w-1/4 flex items-center">
                        <p class="text-2xl text-black font-light mx-3 text-center">Email Id </p>
                    </div>
                    <div class="w-3/4">
                        
                        <input type="email" class="w-9/12" id="email" name="email" placeholder="{{oldData.email}}"/>
                    </div>
                </div>
                <div class="flex mt-2">
                    <div class="w-1/4 flex items-center">
                        <p class="text-2xl text-black font-light mx-3 text-center">Password </p>
                    </div>
                    <div class="w-3/4">
                        
                        <input type="password" class="w-9/12" id="password" name="password"/>
                    </div>
                </div>
                <div class="flex mt-2">
                    <div class="w-1/4 flex items-center">
                        <p class="text-2xl text-black font-light mx-3 text-center">Division</p>
                    </div>
                    <div class="w-3/4">
                        
                        <select id="registerSelectDivison" default-selected="{{oldData.division}}" class="bg-white text-black font-normal  w-full text-start py-3 rounded-xl border-2 border-gray-300 px-3">
                   
                            <option value=""> Select Division</option>
                            <option value="Latin Catholic" >Latin Catholic</option>
                            <option value="Lutheran" >Lutheran</option>
                            <option value="Malankara"> Malankara </option>
                            <option value="Marthoma"> Marthoma </option>
                      >
        
                        </select>
                    </div>
                </div>
                <div class="flex mt-2">
                    <div class="w-1/4 flex items-center">
                        <p class="text-2xl text-black font-light mx-3 text-center">Caste</p>
                    </div>
                    <div class="w-3/4">
                        
                        <input type="text" class="w-9/12" id="caste" name="caste" placeholder="{{oldData.caste}}"/>
                    </div>
                </div>
                <div class="flex mt-2">
                    <div class="w-1/4 flex items-center">
                        <p class="text-2xl text-black font-light mx-3 text-center">Educational Qualification</p>
                    </div>
                    <div class="w-3/4">
                        
                        <input type="text" class="w-9/12" id="educationalQualification" name="educational_qualification" placeholder="{{oldData.educational_qualification}}"/>
                    </div>
                </div>
                <div class="flex mt-2">
                    <div class="w-1/4 flex items-center">
                        <p class="text-2xl text-black font-light mx-3 text-center">EmployedIn</p>
                    </div>
                    <div class="w-3/4">
                        
                        <select id="registerSelectEmployedIn" default-selected="{{oldData.employed_in}}"  class="bg-white text-black font-normal  w-full text-start py-3 rounded-xl border-2 border-gray-300 px-3">
                   
                            <option value=""> Select job</option>
                            <option value="Goverment" >Goverment</option>
                            <option value="Private" >Private</option>
                            <option value="Defence"> Defence </option>
                      >
        
                        </select>
                    </div>
                </div>
                <div class="flex mt-2">
                    <div class="w-1/4 flex items-center">
                        <p class="text-2xl text-black font-light mx-3 text-center">Occupation</p>
                    </div>
                    <div class="w-3/4">
                        
                        <select id="registerSelectOccupation" default-selected="{{oldData.occupation}}" class="bg-white text-black font-normal  w-full text-start py-3 rounded-xl border-2 border-gray-300 px-3">
                   
                            <option value=""> Select Occupation</option>
                            <option value="Software Professional" >Software Professional</option>
                            <option value="Doctor" >Doctor</option>
                            <option value="Manager"> Manager </option>
                      >
        
                        </select>
                    </div>
                </div>
                <input type="text" value="{{oldData.id}}" id="dataId" class="hidden">
                <div class="flex mt-2">
                    <div class="w-1/4 flex items-center">
                        <p class="text-2xl text-black font-light mx-3 text-center">Annual Income</p>
                    </div>
                    <div class="w-3/4">
                        
                        <input type="number" class="w-9/12" id="annual_income" name="annual_income" placeholder="{{oldData.annual_income}}"/>
                    </div>
                </div>
                <div class="flex mt-2">
                    <div class="w-1/4 flex items-center">
                        <p class="text-2xl text-black font-light mx-3 text-center">About you</p>
                    </div>
                    <div class="w-3/4">
                        
                        <textarea type="text" class="w-9/12" id="tell_us_about_yourself" placeholder="{{oldData.tell_us_about_yourself}}" rows="8"></textarea>
                    </div>
                </div>
                
               

                <div class="flex justify-center">
                    <button class="p-3 rounded-xl text-white w-32 bg-green-400 text-center my-8" id="submitBtn">Update</button>
                </div>
            </form>
        {% endblock %}

{% block js %}
<script type="text/javascript">
   const LookingFor = document.querySelector('#registerSelect')
   const positionSelected = LookingFor.getAttribute('default-selected')
   LookingFor.value = positionSelected
   const Occupation = document.querySelector('#registerSelectOccupation')
   const positionSelected2 = Occupation.getAttribute('default-selected')
   Occupation.value = positionSelected2
   const EmployedIN = document.querySelector('#registerSelectEmployedIn')
   const positionSelected3 = EmployedIN.getAttribute('default-selected')
   EmployedIN.value = positionSelected3
   const Division = document.querySelector('#registerSelectDivison')
   const positionSelected4 = Division.getAttribute('default-selected')
   Division.value = positionSelected4
   const Religion = document.querySelector('#registerSelectReligion')
   const positionSelected5 = Religion.getAttribute('default-selected')
   Religion.value = positionSelected5
   const Language = document.querySelector('#registerSelectLanguage')
   const positionSelected6 = Language.getAttribute('default-selected')
   Language.value = positionSelected6
   console.log(positionSelected3)


   const data = {
    looking_for: 'Myself Male',
    username: '',
    phone: '',
    email: '',
    password: '',
    caste: '',
    educational_qualification: '',
    annual_income: ''
};


    const submitBtn = document.querySelector('#submitBtn')
        submitBtn.addEventListener('click',(evt)=>{
            evt.preventDefault()
            applicationId = document.querySelector('#dataId')
            const updateForm = document.querySelector('#updateForm')
            const formData = new FormData(updateForm);

        // Filter out empty fields
        const filteredFormData = new FormData();
        for (const [key, value] of formData.entries()) {
            if (value) { // Only append non-empty values
                filteredFormData.append(key, value);
            }
        }
            fetch(`http://localhost:8000/update_profile/${applicationId.value}/`, {
                    method: 'POST',
                    body: filteredFormData,
                    credentials: 'same-origin',
                })
                .then(response => response.json())
                .then(data => {
                    if(data.userDetailsUpdated){
                        alert('Updated Successully.')
                        location.reload()
                    }else{
                        alert('some error in data.',data.error)
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                });
        })
   
</script>

{% endblock %}